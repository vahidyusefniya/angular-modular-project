<ion-modal
  [backdropDismiss]="false"
  (willDismiss)="onDismiss()"
  [isOpen]="isOpen"
>
  <ng-template>
    <ion-header>
      <ion-toolbar class="px-3">
        <ion-buttons slot="start">
          <ion-button (click)="onDismiss()" color="primary">
            {{ dictionary.Cancel }}
          </ion-button>
        </ion-buttons>
        <ion-title>{{ dictionary.EditCustomer }}</ion-title>
        <ion-buttons slot="end">
          <ion-button
            color="primary"
            [disabled]="!customerEditForm.form.valid"
            (click)="onClickSave()"
          >
            {{ dictionary.Save }}</ion-button
          >
        </ion-buttons>
      </ion-toolbar>
    </ion-header>
    <ion-content>
      <form #customerEditForm="ngForm">
        <ion-grid>
          <ion-row>
            <ion-col size="12" class="mt-3">
              <ion-label class="fs-6">{{ dictionary.PersonalInfo }}</ion-label>
              <hr class="divider my-0" />
            </ion-col>
            <ion-col size="12">
              <app-text
                id="email"
                [Label]="dictionary.Email"
                [(ngModel)]="customer.email!.value"
                name="email"
                [required]="true"
                [email]="true"
              />
            </ion-col>
            <ion-col
              *ngIf="customer.phoneNumber && customer.phoneNumber.value != null"
              size="12"
            >
              <app-mobile
                (keydown.enter)="
                  customerEditForm.form.valid ? onClickSave() : ''
                "
                [Label]="dictionary.PhoneNumber"
                [required]="true"
                name="phoneNumber"
                id="phoneNumber"
                [value]="customer.phoneNumber.value.number"
                [code]="customer.phoneNumber.value.countryCode"
                (inputChange)="phoneNumberChange($event)"
              />
            </ion-col>
            <ion-col
              *ngIf="customer.phoneNumber && customer.phoneNumber.value != null"
              size="12"
            >
              <app-mobile
                (keydown.enter)="
                  customerEditForm.form.valid ? onClickSave() : ''
                "
                [Label]="dictionary.WhatsappNumber"
                [required]="true"
                name="whatsappNumber"
                id="whatsappNumber"
                [value]="customer.whatsappNumber?.value?.number"
                (inputChange)="whatsappNumberChange($event)"
                [code]="customer.whatsappNumber!.value!.countryCode"
              />
            </ion-col>
            <ion-col sizeMd="6" sizeSm="12">
              <app-text
                [Label]="dictionary.Website"
                name="website"
                id="website"
                (keydown.enter)="
                  customerEditForm.form.valid ? onClickSave() : ''
                "
                [(ngModel)]="customer.website!.value"
              />
            </ion-col>
            <ion-col sizeMd="6" sizeSm="12">
              <app-text
                id="timezone"
                [Label]="dictionary.TimeZone"
                name="timezone"
                [readonly]="true"
                (click)="showTimezoneModal = true"
                [(ngModel)]="timezoneName"
                [required]="true"
              />
            </ion-col>
            <ion-col size="12" class="mt-3">
              <ion-label class="fs-6">{{ dictionary.Address }}</ion-label>
              <hr class="divider my-0" />
            </ion-col>
            <ion-col sizeMd="4" sizeSm="12">
              <app-text
                id="country"
                [Label]="dictionary.Country"
                name="country"
                [readonly]="true"
                (click)="showCountryModal = true"
                [(ngModel)]="countryName"
                [required]="true"
              />
            </ion-col>
            <ion-col sizeMd="4" sizeSm="12">
              <app-text
                id="state"
                [Label]="dictionary.StateProvinceTerritory"
                name="state"
                [readonly]="true"
                (click)="countryName !== '' && (showStateModal = true)"
                [(ngModel)]="stateName"
                [disabled]="countryName === ''"
                [required]="true"
              />
            </ion-col>
            <ion-col sizeMd="4" sizeSm="12">
              <app-text
                id="city"
                [Label]="dictionary.City"
                name="city"
                [readonly]="true"
                [disabled]="
                  countryName === '' ||
                  stateName === '' ||
                  stateName === 'Other'
                "
                (click)="
                  countryName !== '' &&
                    stateName !== '' &&
                    stateName !== 'Other' &&
                    (showCityModal = true)
                "
                [(ngModel)]="cityName"
                [required]="true"
              />
            </ion-col>
            <ion-col size="12">
              <app-text
                [Label]="dictionary.Address"
                name="address"
                id="address"
                (keydown.enter)="
                  customerEditForm.form.valid ? onClickSave() : ''
                "
                [(ngModel)]="addressObj.rawAddress"
                [required]="true"
              />
            </ion-col>
            <ion-col size="12">
              <app-text
                id="postalCode"
                [Label]="dictionary.ZIPPostalCode"
                name="postalCode"
                [(ngModel)]="addressObj.postalCode"
                [required]="true"
              />
            </ion-col>
            <ion-col size="12">
              <ion-item
                href="#"
                routerLinkActive="active"
                lines="none"
                detail="false"
              >
                <ion-toggle
                  color="success"
                  name="canPreOrder"
                  class="w-100 w-sm-auto"
                  [(ngModel)]="customer.isActive!.value"
                >
                  {{ dictionary.Activate }}
                </ion-toggle>
              </ion-item>
            </ion-col>
          </ion-row>
        </ion-grid>
      </form>
    </ion-content>
  </ng-template>
</ion-modal>

<app-radio-list
  [isOpen]="showCountryModal"
  *ngIf="showCountryModal"
  (dismiss)="showCountryModal = false"
  [data]="countries"
  [title]="dictionary.SelectCountry"
  (select)="selectCountry($event)"
  [selectedObject]="country"
/>

<app-radio-list
  [isOpen]="showStateModal"
  *ngIf="showStateModal"
  (dismiss)="showStateModal = false"
  [data]="states"
  [title]="dictionary.SelectStateProvinceTerritory"
  (select)="selectState($event)"
  [selectedObject]="state"
/>

<app-radio-list
  [isOpen]="showCityModal"
  *ngIf="showCityModal"
  (dismiss)="showCityModal = false"
  [data]="cities"
  [title]="dictionary.SelectCity"
  (select)="selectCity($event)"
  [selectedObject]="city"
/>

<app-timezones
  [isOpen]="showTimezoneModal"
  *ngIf="showTimezoneModal"
  (dismiss)="showTimezoneModal = false"
  [data]="timezones"
  [title]="dictionary.SelectTimezone"
  (select)="selectTimezone($event)"
  [selectedObject]="timezone"
/>
